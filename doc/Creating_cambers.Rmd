---
title: "Creating Cambers Notebook"
output: html_notebook
---

# Foil Study -- Creating Cambers

This notebook will guide you through creating the necessary airfoils to run the foil study. It uses the R scripts found in ./src/r-scripts and the parameter list of cambers in ./data/camber_list.csv to alter the NACA airfoil ./data/AS6091.csv to produce airfoils with different cambers, the output will be located in ./data/. 

Please ensure that the notebook is being knitted through the project directory: select the drop down arrow next to "Preview" and then "Knit Directory" and "Project Directory."

```{r}
# functions
source("./src/r-scripts/foil_functions.R")
```

Define new camber: 

```{r}
camber_new <- 0.10
```

Load baseline airfoil: 

```{r}
foil <- read.table("./data/AS6091.dat", skip = 0)
colnames(foil) <- c("x", "y")
npts <- nrow(foil)
plot(y~x, data = foil, type = "o", asp = 1, col = viridis::viridis(npts))
for(i in 1:80) lines(x = c(foil$x[i], foil$x[(npts + 1) - i]), 
                     y = c(foil$y[i], foil$y[(npts + 1) - i]))
```

Calculate midline: 
```{r}
foil_midline_sm <- find_midline(foil$x, foil$y)
```
Calculate original camber: 

```{r}
calc_camber(foil_midline_sm$x, foil_midline_sm$y)
```

Create new midline: 
```{r}
new_midline <- adjust_midline(foil_midline_sm, camber_new, plot = TRUE)
```

Create new foil based on midline and thicknesses: 

```{r}
new_foil <- create_new_foil(new_midline, plot = TRUE)
```

**There is some issue with the foil points near the tail are crossing over each other, which is pissing off XFOIL. Go back and fix this.

Check new camber against specified value:

```{r}
calc_camber(new_midline$x, new_midline$y, camber_new)
```


Write new foil to a file:

```{r}
write.table(new_foil, file = "./data/ASnew.dat", row.names = F, col.names = F)
```


### Produce all airfoil files

Please run the following script: 
```{r}
#source("./src/r-scripts/calculate_cambers.R", echo = F)
```